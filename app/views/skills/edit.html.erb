<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <%= stylesheet_link_tag 'custom', media: 'all', 'data-turbolinks-track': 'reload' %>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const pullDownButton = document.querySelector('.pull-down-button');
      const dropdownContent = document.createElement('div');
      dropdownContent.className = 'dropdown-content';
      const currentDate = new Date();
      const currentMonth = currentDate.getMonth() + 1;

      // 当月の月表示
      pullDownButton.textContent = currentMonth + '月';

      // プルダウンの中身を設定
      for (let i = 0; i < 3; i++) {
        const button = document.createElement('button');
        let displayMonth = currentMonth - i;

        if (displayMonth <= 0) {
          displayMonth += 12;
        }

        button.value = displayMonth;
        button.textContent = displayMonth + '月';
        button.addEventListener('click', function() {
          pullDownButton.textContent = displayMonth + '月';
          dropdownContent.style.display = 'none';
          // 選択した月の処理をここに追加
          filterContentByMonth(displayMonth);
        });

        dropdownContent.appendChild(button);
      }

      // ボタンをクリックするとドロップダウンを表示/非表示
      pullDownButton.addEventListener('click', function() {
        dropdownContent.style.display = dropdownContent.style.display === 'block' ? 'none' : 'block';
      });

      document.querySelector('.dropdown').appendChild(dropdownContent);

      // 選択した月に基づいてコンテンツをフィルタリングする関数
      function filterContentByMonth(month) {
        const allRows = document.querySelectorAll('.table-group tbody tr');
        allRows.forEach(row => {
          const monthData = row.querySelector('.month-data');
          if (monthData && monthData.getAttribute('data-month') == month) {
            row.style.display = '';
          } else {
            row.style.display = 'none';
          }
        });
      }

      // 初期表示時に当月のデータを表示する
      displayContentByMonth(currentMonth);
    });
  </script>
</head>
<body>
  <header>
    <h6><a href="<%= user_path(@user) %>">My Portfolio</a></h6>
    <%= link_to "ログアウト", logout_path, class: "button_logout", data: { "turbo-method": :delete } %>
  </header>
  <div class="wrapper-skill">
    <div class="month-select-area dropdown">
      <button class="pull-down-button"></button>
    </div>

    <div class="category">
      <div class="content">
        <div class="title-group">
          <div class="title">バックエンド</div>
          <button class="button_blue">項目を追加する</button>
        </div>
        <table class="teble-group">
          <thead>
            <tr>
              <th>項目名</th>
              <th>学習時間</th>
              <th></th>
              <th></th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Ruby</td>
              <td>
                <div class="time-select-area">
                  <select class="time-select">
                    <% (1..60).each do |minute| %>
                      <option value="<%= minute %>"><%= minute %></option>
                    <% end %>
                  </select>
                </div>
              </td>
              <td>
                <button class="button-blue-save">学習時間を保存する</button>
              </td>
              <td><button class="button-red">削除する</button></td>
            </tr>
            <tr>
              <td>Rails</td>
              <td>
                <div class="time-select-area">
                  <select class="time-select">
                    <% (1..60).each do |minute| %>
                      <option value="<%= minute %>"><%= minute %></option>
                    <% end %>
                  </select>
                </div>
              </td>
              <td><button class="button-blue-save">学習時間を保存する</button></td>
              <td><button class="button-red">削除する</button></td>
            </tr>
            <tr>
              <td>MySQL</td>
              <td>
                <div class="time-select-area">
                  <select class="time-select">
                    <% (1..60).each do |minute| %>
                      <option value="<%= minute %>"><%= minute %></option>
                    <% end %>
                  </select>
                </div>
              </td>
              <td><button class="button-blue-save">学習時間を保存する</button></td>
              <td><button class="button-red">削除する</button></td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
    <div class="category">
      <div class="content">
        <div class="title-group">
          <div class="title">フロントエンド</div>
          <button class="button_blue">項目を追加する</button>
        </div>
        <table class="teble-group">
          <thead>
            <tr>
              <th>項目名</th>
              <th>学習時間</th>
              <th></th>
              <th></th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>HTML</td>
              <td>
                <div class="time-select-area">
                  <select class="time-select">
                    <% (1..60).each do |minute| %>
                      <option value="<%= minute %>"><%= minute %></option>
                    <% end %>
                  </select>
                </div>
              </td>
              <td><button class="button-blue-save">学習時間を保存する</button></td>
              <td><button class="button-red">削除する</button></td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <div class="category">
      <div class="content">
        <div class="title-group">
          <div class="title">インフラ</div>
          <button class="button_blue">項目を追加する</button>
        </div>
        <table class="teble-group">
          <thead>
            <tr>
              <th>項目名</th>
              <th>学習時間</th>
              <th></th>
              <th></th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Heroku</td>
              <td>
                <div class="time-select-area">
                  <select class="time-select">
                    <% (1..60).each do |minute| %>
                      <option value="<%= minute %>"><%= minute %></option>
                    <% end %>
                  </select>
                </div>
              </td>
              <td><button class="button-blue-save">学習時間を保存する</button></td>
              <td><button class="button-red">削除する</button></td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</body>
</html>
